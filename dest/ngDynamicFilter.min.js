var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Directive=function(){function t(){this.restrict="E",this.templateUrl=function(t,e){return e.templateUrl},this.scope={options:"=",onSelect:"&"}}return t.prototype.link=function(t,e,n,i){t.apply=function(){var e=t.filters.getResult();t.onSelect({result:e})},t.filters=new Filters(t.apply)},t.prototype.validate=function(){console.log(this)},t.instance=function(){return new t},t}();angular.module("ngDynamicFilter",[]).directive("dynamicFilter",Directive.instance);var Filter=function(){function t(t){this.field=null,this.values=null,this.callback=t}return t.prototype.addValue=function(){this.canAddValue()&&this.values.push(new Value(this.callback))},t.prototype.canAddValue=function(){return!!this.values&&(null!=this.values[this.values.length-1].value&&OptionType[this.type]!=OptionType.TEXT.toString())},t.prototype.onSelect=function(t){this.field=t.field,this.type=t.type,this.options=t.options,this.params=t.params,this.values=[new Value(this.callback)]},t.prototype.getValues=function(t){var e=this.field;return t.filter(function(t){return t.field==e})[0].options},t}(),Filters=function(t){function e(e){var n=t.call(this)||this;return n.callback=e,n}return __extends(e,t),e.prototype.add=function(){var t=this[this.length-1];t&&!t.field||this.push(new Filter(this.callback))},e.prototype.removeLast=function(){this.splice(-1,1),this.callback()},e.prototype.isFilterSelected=function(t){return this.some(function(e){return e.field==t.field})},e.prototype.isValueSelected=function(t){return this.some(function(e){return e.values&&e.values.some&&e.values.some(function(e){return e.value==t})})},e.prototype.getResult=function(){return this.map(function(t){var e={};return e[t.field]=t.values.map(function(t){return t.value}),e})},e}(Array),OptionType;!function(t){t[t.TEXT=0]="TEXT",t[t.AUTOCOMPLETE=1]="AUTOCOMPLETE",t[t.OPTIONS=2]="OPTIONS"}(OptionType||(OptionType={}));var Value=function(){function t(t){this.callback=t,this.value=null,this.skipApply=!1}return t.prototype.onSelect=function(t){this.value=t,this.skipApply||this.callback()},t}();